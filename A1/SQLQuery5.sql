CREATE PROCEDURE SP_FUNCIONARIOS_FAIXA_SALARIAL AS

SELECT 
        CASE
            WHEN salario BETWEEN 1 AND 3000 THEN 1
            WHEN salario BETWEEN 3001 AND 6000 THEN 3001
            WHEN salario BETWEEN 6001 AND 9000 THEN 6001
            WHEN salario BETWEEN 9001 AND 12000 THEN 9001
            WHEN salario BETWEEN 12001 AND 15000 THEN 12001
            WHEN salario BETWEEN 15001 AND 18000 THEN 15001
            WHEN salario BETWEEN 18001 AND 21000 THEN 18001
            WHEN salario BETWEEN 21001 AND 24000 THEN 21001
            WHEN salario BETWEEN 24001 AND 27000 THEN 24001
        END AS valor_salario_inicial,
        CASE
            WHEN salario BETWEEN 1 AND 3000 THEN 3000
            WHEN salario BETWEEN 3001 AND 6000 THEN 6000
            WHEN salario BETWEEN 6001 AND 9000 THEN 9000
            WHEN salario BETWEEN 9001 AND 12000 THEN 12000
            WHEN salario BETWEEN 12001 AND 15000 THEN 15000
            WHEN salario BETWEEN 15001 AND 18000 THEN 18000
            WHEN salario BETWEEN 18001 AND 21000 THEN 21000
            WHEN salario BETWEEN 21001 AND 24000 THEN 24000
            WHEN salario BETWEEN 24001 AND 27000 THEN 27000
        END AS valor_salario_final,
        SUM(CASE WHEN Sexo = 'F' THEN 1 ELSE 0 END) AS quantidade_mulheres,
        SUM(CASE WHEN Sexo = 'M' THEN 1 ELSE 0 END) AS quantidade_homens
    FROM FUNCIONARIO
    GROUP BY 
        CASE
             WHEN salario BETWEEN 1 AND 3000 THEN 1
            WHEN salario BETWEEN 3001 AND 6000 THEN 3001
            WHEN salario BETWEEN 6001 AND 9000 THEN 6001
            WHEN salario BETWEEN 9001 AND 12000 THEN 9001
            WHEN salario BETWEEN 12001 AND 15000 THEN 12001
            WHEN salario BETWEEN 15001 AND 18000 THEN 15001
            WHEN salario BETWEEN 18001 AND 21000 THEN 18001
            WHEN salario BETWEEN 21001 AND 24000 THEN 21001
            WHEN salario BETWEEN 24001 AND 27000 THEN 24001
        END,
        CASE
            WHEN salario BETWEEN 1 AND 3000 THEN 3000
            WHEN salario BETWEEN 3001 AND 6000 THEN 6000
            WHEN salario BETWEEN 6001 AND 9000 THEN 9000
            WHEN salario BETWEEN 9001 AND 12000 THEN 12000
            WHEN salario BETWEEN 12001 AND 15000 THEN 15000
            WHEN salario BETWEEN 15001 AND 18000 THEN 18000
            WHEN salario BETWEEN 18001 AND 21000 THEN 21000
            WHEN salario BETWEEN 21001 AND 24000 THEN 24000
            WHEN salario BETWEEN 24001 AND 27000 THEN 27000
		END
